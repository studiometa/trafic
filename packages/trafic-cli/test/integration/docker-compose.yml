# Docker Compose for SSH integration tests
# Used in CI (GitHub Actions) when OrbStack is not available

services:
  ssh-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: trafic-ssh-test
    ports:
      - "2222:22"
    volumes:
      # Mount SSH public key for authentication
      - ${SSH_AUTH_KEY:-~/.ssh/id_ed25519.pub}:/home/testuser/.ssh/authorized_keys:ro
    healthcheck:
      test: ["CMD", "pgrep", "sshd"]
      interval: 2s
      timeout: 5s
      retries: 10
      start_period: 2s
