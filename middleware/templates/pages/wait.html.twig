{% extends 'layouts/base.html.twig' %}

{% block body %}
	<main>
		<p>ğŸ’¤</p>
		<p>DÃ» Ã  une inactivitÃ© prolongÃ©e, cet environnement a Ã©tÃ© stoppÃ©.</p>
		<p>Le serveur redÃ©marre, cette page sera automatiquement actualisÃ©e dÃ¨s quâ€™il sera prÃªt.</p>
		<p id="status">ğŸ’¤ En veille...</p>
		<p><i>â€” Studio Meta</i></p>
	</main>

	<script type="module">
		const state = document.querySelector('#status');

		async function test() {
			const { status } = await fetch(location).catch(() => {});

			switch (status) {
				case 200:
					location.reload();
					break;
				case 502:
					setTimeout(test, 500);
					state.textContent = 'ğŸš€ Encore quelques secondes...';
					break;
				default:
					state.textContent = 'âš™ï¸ RedÃ©marrage...';
					setTimeout(test, 500);
					break;
			}
		}

		test();
	</script>
{% endblock %}
