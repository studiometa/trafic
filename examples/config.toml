# Trafic agent configuration
# Place this file at /etc/trafic/config.toml on your DDEV server

# Required: TLD for DDEV projects
tld = "previews.example.com"

# Scale-to-zero: stop idle projects after this duration
idle_timeout = "4h"

# Authentication rules
[auth]
# Default: require basic auth for all hostnames
default = "basic"

# IP whitelist (no auth needed from these IPs)
whitelist = [
  "192.168.1.0/24",
  "10.0.0.0/8",
]

# Basic auth credentials
[auth.basic]
username = "preview"
password = "changeme"

# Per-hostname rules
[[auth.rules]]
hostname = "*.staging.*"
policy = "basic"

[[auth.rules]]
hostname = "*.public.*"
policy = "allow"

# Token-based auth (for CI webhooks, APIs, etc.)
[[auth.tokens]]
name = "ci-runner"
token = "your-secret-token-here"
